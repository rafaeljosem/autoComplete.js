!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.t=n():"function"==typeof define&&define.i?define(n):t.o=n()}(this,function(){"use strict";function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.u=i.u||!1,i.s=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t){return"string"==typeof t?document.querySelector(t):t()}function c(t){return t.innerHTML=""}function n(t,n){n=n||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),e}var a="data-result",e="autoComplete_results_list",f="autoComplete_result",i="autoComplete_highlighted",o=s,u=function(t){var n=document.createElement(t.l);return n.setAttribute("id",e),t.h&&t.h(n),t.destination.insertAdjacentElement(t.position,n),n},l=function(t){return"<span class=".concat(i,">").concat(t,"</span>")},r=function(o,u,r){u.forEach(function(t,n){var e=document.createElement(r.l),i=u[n].value[t.key]||u[n].value;e.setAttribute(a,i),e.setAttribute("class",f),e.setAttribute("tabindex","1"),r.content?r.content(t,e):e.innerHTML=t.match||t,o.appendChild(e)})},h=function(t,e,i){var o=s(t),u=e.firstChild;document.onkeydown=function(t){var n=i.activeElement;switch(t.keyCode){case 38:n!==u&&n!==o?n.previousSibling.focus():n===u&&o.focus();break;case 40:n===o&&0<e.childNodes.length?u.focus():n!==e.lastChild&&n.nextSibling.focus()}}},v=c,d=function(i,o,u,r){var e=o.querySelectorAll(".".concat(f));Object.keys(e).forEach(function(n){["mousedown","keydown"].forEach(function(t){e[n].addEventListener(t,function(e){"mousedown"!==t&&13!==e.keyCode&&39!==e.keyCode||(u({event:e,query:s(i)instanceof HTMLInputElement?s(i).value:s(i).innerHTML,matches:r.matches,v:r.list.map(function(t){return t.value}),selection:r.list.find(function(t){var n=t.value[t.key]||t.value;e.target.closest(".".concat(f)).getAttribute(a);return n===e.target.closest(".".concat(f)).getAttribute(a)})}),c(o))})})})};n.prototype=window.Event.prototype;var m,p,y,w={m:"function"==typeof window.CustomEvent&&window.CustomEvent||n,p:function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(t){var n=this;do{if(n.matches(t))return n;n=n.parentElement||n.parentNode}while(null!==n&&1===n.nodeType);return null})}};function b(t){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,b),this.selector=t.selector||"#autoComplete",this.data={src:function(){return"function"==typeof t.data.src?t.data.src():t.data.src},key:t.data.key,C:void 0===t.data.C||t.data.C},this.query=t.query,this.g={event:t.g&&t.g.event?t.g.event:["input"],k:!(!t.g||!t.g.k)&&t.g.k},this.T="loose"===t.T?"loose":"function"==typeof t.T?t.T:"strict",this.threshold=t.threshold||0,this.P=t.P||0,this._={j:!(!t._||!t._.j)&&t._.j,shadowRoot:t._&&t._.shadowRoot?t._.shadowRoot:document,view:t._&&t._.j?u({h:!(!t._||!t._.h)&&t._.h,destination:t._&&t._.destination?t._.destination:o(this.selector),position:t._&&t._.position?t._.position:"afterend",l:t._&&t._.l?t._.l:"ul"}):null,navigation:!(!t._||!t._.navigation)&&t._.navigation},this.sort=t.sort||!1,this.M=t.M,this.R=t.R||5,this.q={content:!(!t.q||!t.q.content)&&t.q.content,l:t.q&&t.q.l?t.q.l:"li"},this.H=t.H,this.I=t.I||!1,this.L=t.L,this.dataSrc,this.init()}return m=b,(p=[{key:"search",value:function(t,n){var e=n.toLowerCase();if("loose"===this.T){t=t.replace(/ /g,"");for(var i=[],o=0,u=0;u<e.length;u++){var r=n[u];o<t.length&&e[u]===t[o]&&(r=this.I?l(r):r,o++),i.push(r)}return o===t.length&&i.join("")}if(e.includes(t))return t=new RegExp("".concat(t),"i").exec(n),this.I?n.replace(t,l(t)):n}},{key:"listMatchedResults",value:function(e,i){var a=this;return new Promise(function(t){var c=[];e.filter(function(o,u){function t(t){var n=t?o[t]:o,e=c.find(function(t){return t.value===o});if(n){var i="function"==typeof a.T?a.T(a.O,n):a.search(a.O,n);i&&t&&!e?c.push({key:t,index:u,match:i,value:o}):!i||t||e||c.push({index:u,match:i,value:o})}}if(a.data.key){var n=!0,e=!1,i=void 0;try{for(var r,s=a.data.key[Symbol.iterator]();!(n=(r=s.next()).done);n=!0)t(r.value)}catch(t){e=!0,i=t}finally{try{n||null==s.S||s.S()}finally{if(e)throw i}}}else t()});var n=a.sort?c.sort(a.sort).slice(0,a.R):c.slice(0,a.R);return a._.j&&(r(a._.view,n,a.q),a._.navigation?a._.navigation(i,a._.view,o(a.selector)):h(a.selector,a._.view,a._.shadowRoot)),t({matches:c.length,list:n})})}},{key:"ignite",value:function(){var r=this,s=o(this.selector);function e(n){function e(t,n){s.dispatchEvent(new w.m("autoComplete",{bubbles:!0,detail:{event:t,input:i,query:o,matches:n?n.matches:null,v:n?n.list:null},cancelable:!0}))}var i=s instanceof HTMLInputElement?s.value.toLowerCase():s.innerHTML.toLowerCase(),o=r.O=r.query&&r.query.W?r.query.W(i):i,t=r._.j,u=r.g.k||o.length>r.threshold&&o.replace(/ /g,"").length;t?(v(r._.view),u?r.A(r.dataSrc,n).then(function(t){e(n,t),0===t.list.length&&r.H&&r._.j?r.H():r.L&&d(r.selector,r._.view,r.L,t)}):e(n)):!t&&u?r.A(r.dataSrc,n).then(function(t){e(n,t)}):e(n)}this.M&&s.setAttribute("placeholder",this.M),this.g.event.forEach(function(t){s.addEventListener(t,function(e,i){var o;return function(){var t=this,n=arguments;clearTimeout(o),o=setTimeout(function(){return e.apply(t,n)},i)}}(function(t){return function(n){r.data.C?e(n):r.data.src()instanceof Promise?r.data.src().then(function(t){r.dataSrc=t,e(n)}):(r.dataSrc=r.data.src(),e(n))}(t)},r.P))})}},{key:"init",value:function(){var n=this;this.data.src()instanceof Promise?this.data.src().then(function(t){n.dataSrc=t,n.B()}):(this.dataSrc=this.data.src(),this.B()),w.p()}}])&&t(m.prototype,p),void(y&&t(m,y)),b});